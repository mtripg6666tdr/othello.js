!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.othello=t():e.othello=t()}(self,(function(){return(()=>{"use strict";var e={187:e=>{var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function a(e,t,n,r){var o,i,s,a;if(l(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=u(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=c.bind(r);return o.listener=n,r.wrapFn=o,o}function h(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):d(o,o.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw l.context=s,l}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)r(u,this,t);else{var a=u.length,c=d(u,a);for(n=0;n<a;++n)r(c[n],this,t)}return!0},i.prototype.addListener=function(e,t){return a(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return a(this,e,t,!0)},i.prototype.once=function(e,t){return l(t),this.on(e,f(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,f(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,o,i,s;if(l(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},914:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultGameConfig=void 0,t.defaultGameConfig={firstMove:"white"}},769:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const r=n(187),o=n(914),i=n(607);class s extends r.EventEmitter{constructor(e){super(),this._board=null,this._state={status:"finish"},this._config=null,this._config=Object.assign(Object.assign({},e),o.defaultGameConfig),this._board=new i.OthelloBoardManager(this._config)}get white(){return this._board.getInfo("white")}get black(){return this._board.getInfo("black")}get state(){return this._state}set state(e){this._state=e}get board(){return this._board}put(e){this._board.put(e)}logBoard(){console.log("  ０１２３４５６７"),console.log("  ――――――――");for(let e=0;e<8;e++){const t=e+"|"+[...Array(8)].map(((t,n)=>{switch(this._board.getCell(n,e).type){case"black":return"●";case"white":return"○";case"none":return"　"}})).join("")+"|";console.log(t)}console.log("  ――――――――"),console.log("Next: "+("black"===this._board.nextStone?"●":"○")+this._board.nextStone),console.log("Turn count: "+this.board.log.length)}}t.Game=s},607:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OthelloBoardManager=void 0;const r=n(158),o=n(464);t.OthelloBoardManager=class{constructor(e){this._config=e,this._data=null,this._log=[],this._data=[...Array(8)].map(((e,t)=>[...Array(8)].map(((e,n)=>new r.CellStatus("none",t,n))))),this.setCell("black",{x:3,y:3},{x:4,y:4}).setCell("white",{x:3,y:4},{x:4,y:3})}get putLog(){return this._log}getInfo(e){return new o.StoneStatus(this.sumCell((t=>t.type===e)))}get nextStone(){return"black"===this.getLastMover()?"white":"black"}get log(){return this._log}put(e){let t=null;const n=[];if("put"===e.type){const t=this.getCell(e.x,e.y);if(this.getLastMover()===e.current)throw new Error("two consecutive mover");if("none"!==t.type)throw new Error("the cell has already been put a stone on");const r=this.getAroundCells(e.x,e.y);if(0===r.length)throw new Error("the cell surrounded by no stone");if(0===r.filter((e=>e.type!==t.type)).length)throw new Error("the cell surrounded by no stone of the other type");const o={row:!1,column:!1,plusdiagonal:!1,minusdiagonal:!1},i={row:null,column:null,plusdiagonal:null,minusdiagonal:null},s=i.row=this.getRow(e.y);o.row=this.replaceCells(e,e.x,s,"plus")||this.replaceCells(e,e.x,s,"minus");const l=i.column=this.getColumn(e.x);o.column=this.replaceCells(e,e.y,l,"plus")||this.replaceCells(e,e.y,l,"minus");const u=i.plusdiagonal=this.getPlusDiagonals(e);o.plusdiagonal=this.replaceCells(e,u.findIndex((t=>e.x===t.x)),u,"plus")||this.replaceCells(e,u.findIndex((t=>e.x===t.x)),u,"minus");const a=i.minusdiagonal=this.getMinusDiagnals(e);if(o.minusdiagonal=this.replaceCells(e,a.findIndex((t=>e.x===t.x)),a,"plus")||this.replaceCells(e,a.findIndex((t=>e.x===t.x)),a,"minus"),!(o.row||o.column||o.plusdiagonal||o.minusdiagonal))throw new Error("no cell to turn");["row","column","plusdiagonal","minusdiagonal"].forEach((e=>{o[e]&&i[e].forEach((e=>{this.getCell(e.x,e.y)!==e&&(this._data[e.x][e.y]=e,n.push(e))}))})),this.setCell(e.current,e)}if(0===this.sumCell((e=>"none"===e.type))){const e=this.sumCell((e=>"white"===e.type)),n=this.sumCell((e=>"black"===e.type));t=e>n?"white":e===n?"draw":e<n?"black":null}const r=Object.assign(Object.assign({},e),{winner:t,modified:n});return this._log.push(r),r}setCell(e,...t){return t.forEach((t=>{this._data[t.x][t.y]=new r.CellStatus(e,t.x,t.y)})),this}getCell(e,t){return this._data[e][t]}getAroundCells(e,t){const n=[];return[this._data[e-1],this._data[e],this._data[e+1]].filter((e=>Boolean(e))).forEach((e=>{n.push(...[e[t-1],e[t],e[t+1]].filter((e=>Boolean(e))))})),n}getColumn(e){return[...this._data[e]]}getRow(e){return[...Array(8)].map(((t,n)=>this._data[n][e]))}getPlusDiagonals(e){const t=e.x+e.y,n=[];for(let e=0;e<=7;e++){const r=this.getColumn(e);r&&n.push(r[t-e])}return n.filter((e=>Boolean(e)))}getMinusDiagnals(e){const t=e.x-e.y,n=[];for(let e=0;e<=7;e++){const r=this.getColumn(e);r&&n.push(r[e-t])}return n.filter((e=>Boolean(e)))}getLastMover(){return this._log.length>0?this._log[this._log.length-1].current:"black"===this._config.firstMove?"white":"black"}sumCell(e){let t=0;return this._data.forEach((n=>{n.forEach((n=>{e(n)&&t++}))})),t}replaceCells(e,t,n,o){if(n.length===t+1&&"plus"===o||0===t&&"minus"===o)return!1;if("plus"===o){let o=-1,i=-1;for(let r=t+1;r<n.length&&"none"!==n[r].type&&n[r].type!==e.current;r++)if(-1===o)o=r,i=r;else{if(i+1!==r)break;i=r}if(-1===o||n[i+1].type!==e.current)return!1;for(let t=o;t<=i;t++)n[t]=new r.CellStatus(e.current,n[t].x,n[t].y);return!0}{let o=-1,i=-1;for(let r=t-1;r>=0&&"none"!==n[r].type&&n[r].type!==e.current;r--)if(-1===o)o=r,i=r;else{if(i-1!==r)break;i=r}if(-1===o||n[i-1].type!==e.current)return!1;for(let t=o;t>=i;t--)n[t]=new r.CellStatus(e.current,n[t].x,n[t].y);return!0}}}},158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellStatus=void 0,t.CellStatus=class{constructor(e,t,n){this.type=e,this.x=t,this.y=n}}},464:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StoneStatus=void 0,t.StoneStatus=class{constructor(e){this.count=e}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var t=n(769);Object.defineProperty(e,"Game",{enumerable:!0,get:function(){return t.Game}})})(),r})()}));